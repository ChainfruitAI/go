# pip install scikit-learn matplotlib seaborn pandas numpy

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.mixture import GaussianMixture
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, confusion_matrix, silhouette_score

file_path =  r'iris.csv'
data = pd.read_csv(file_path)

print("Dataset Preview:")
print(data.head())



X = data[['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm']]


scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)


species_mapping = {'Iris-setosa': 0, 'Iris-versicolor': 1, 'Iris-virginica': 2}
data['True_Labels'] = data['Species'].map(species_mapping)


kmeans = KMeans(n_clusters=3, random_state=42)
kmeans.fit(X_scaled)
data['KMeans_Labels'] = kmeans.labels_


gmm = GaussianMixture(n_components=3, random_state=42)
gmm.fit(X_scaled)
data['GMM_Labels'] = gmm.predict(X_scaled)


def align_labels(true_labels, predicted_labels):
    
    cm = confusion_matrix(true_labels, predicted_labels)
    new_labels = np.zeros_like(predicted_labels)
    for i in range(cm.shape[0]):
        
        most_common_label = np.argmax(cm[i])
        new_labels[predicted_labels == i] = most_common_label
    return new_labels


kmeans_aligned_labels = align_labels(data['True_Labels'], data['KMeans_Labels'])
kmeans_accuracy = accuracy_score(data['True_Labels'], kmeans_aligned_labels)
kmeans_conf_matrix = confusion_matrix(data['True_Labels'], kmeans_aligned_labels)


gmm_aligned_labels = align_labels(data['True_Labels'], data['GMM_Labels'])
gmm_accuracy = accuracy_score(data['True_Labels'], gmm_aligned_labels)
gmm_conf_matrix = confusion_matrix(data['True_Labels'], gmm_aligned_labels)



plt.figure(figsize=(12, 5))


plt.subplot(1, 2, 1)
plt.scatter(X_scaled[:, 2], X_scaled[:, 3], c=kmeans_aligned_labels, cmap='viridis')
plt.title('K-Means Clustering (Aligned)')
plt.xlabel('Petal Length (standardized)')
plt.ylabel('Petal Width (standardized)')


plt.subplot(1, 2, 2)
plt.scatter(X_scaled[:, 2], X_scaled[:, 3], c=gmm_aligned_labels, cmap='viridis')
plt.title('Gaussian Mixture Model Clustering (Aligned)')
plt.xlabel('Petal Length (standardized)')
plt.ylabel('Petal Width (standardized)')

plt.tight_layout()
plt.show()


print(f"\nK-Means Accuracy (Aligned): {kmeans_accuracy:.4f}")
print(f"GMM Accuracy (Aligned): {gmm_accuracy:.4f}")

print("\nK-Means Confusion Matrix (Aligned):")
print(kmeans_conf_matrix)

print("\nGMM Confusion Matrix (Aligned):")
print(gmm_conf_matrix)

kmeans_sil_score = silhouette_score(X_scaled, kmeans_aligned_labels)
gmm_sil_score = silhouette_score(X_scaled, gmm_aligned_labels)

print(f"\nSilhouette Score for K-Means: {kmeans_sil_score:.4f}")
print(f"Silhouette Score for GMM: {gmm_sil_score:.4f}")


#4b - EXCLUDED


# pip install scikit-learn matplotlib seaborn pandas numpy scipy

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.mixture import GaussianMixture
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA
from sklearn.metrics import accuracy_score, confusion_matrix, silhouette_score
from scipy.optimize import linear_sum_assignment


file_path = r'iris.csv'  
data = pd.read_csv(file_path)

print("Dataset Preview:")
print(data.head())


X = data[['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm']]


scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)


pca = PCA(n_components=2)
X_pca = pca.fit_transform(X_scaled)


kmeans = KMeans(n_clusters=3, init='k-means++', n_init=10, random_state=42)
kmeans.fit(X_scaled)


gmm = GaussianMixture(n_components=3, covariance_type='full', n_init=10, random_state=42)
gmm.fit(X_scaled)



plt.figure(figsize=(12, 6))


plt.subplot(1, 2, 1)
plt.scatter(X_pca[:, 0], X_pca[:, 1], c=kmeans.labels_, cmap='viridis')
plt.title('K-Means++ Clustering')
plt.xlabel('PCA 1')
plt.ylabel('PCA 2')


plt.subplot(1, 2, 2)
plt.scatter(X_pca[:, 0], X_pca[:, 1], c=gmm.predict(X_scaled), cmap='viridis')
plt.title('Gaussian Mixture Model (EM)')
plt.xlabel('PCA 1')
plt.ylabel('PCA 2')

plt.tight_layout()
plt.show()


species_mapping = {'Iris-setosa': 0, 'Iris-versicolor': 1, 'Iris-virginica': 2}
data['True_Labels'] = data['Species'].map(species_mapping)


def align_labels(true_labels, pred_labels):
    cm = confusion_matrix(true_labels, pred_labels)
    row_ind, col_ind = linear_sum_assignment(-cm)
    new_labels = np.zeros_like(pred_labels)
    for i, j in zip(row_ind, col_ind):
        new_labels[pred_labels == j] = i
    return new_labels


kmeans_aligned = align_labels(data['True_Labels'], kmeans.labels_)
kmeans_accuracy = accuracy_score(data['True_Labels'], kmeans_aligned)


gmm_pred = gmm.predict(X_scaled)
gmm_aligned = align_labels(data['True_Labels'], gmm_pred)
gmm_accuracy = accuracy_score(data['True_Labels'], gmm_aligned)


kmeans_sil_score = silhouette_score(X_scaled, kmeans.labels_)
gmm_sil_score = silhouette_score(X_scaled, gmm_pred)


print("\n--- CLUSTERING RESULTS ---")
print(f"K-Means++ Accuracy (Aligned): {kmeans_accuracy:.4f}")
print(f"GMM (EM) Accuracy (Aligned): {gmm_accuracy:.4f}")

print("\nK-Means++ Confusion Matrix:")
print(confusion_matrix(data['True_Labels'], kmeans_aligned))

print("\nGMM (EM) Confusion Matrix:")
print(confusion_matrix(data['True_Labels'], gmm_aligned))

print(f"\nSilhouette Score for K-Means++: {kmeans_sil_score:.4f}")
print(f"Silhouette Score for GMM (EM): {gmm_sil_score:.4f}")
